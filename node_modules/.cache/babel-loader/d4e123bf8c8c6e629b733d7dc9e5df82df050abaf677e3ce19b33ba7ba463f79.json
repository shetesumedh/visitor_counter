{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.withRetry = withRetry;\nconst wait_js_1 = require(\"../wait.js\");\nfunction withRetry(fn, {\n  delay: delay_ = 100,\n  retryCount = 2,\n  shouldRetry = () => true\n} = {}) {\n  return new Promise((resolve, reject) => {\n    const attemptRetry = async ({\n      count = 0\n    } = {}) => {\n      const retry = async ({\n        error\n      }) => {\n        const delay = typeof delay_ === 'function' ? delay_({\n          count,\n          error\n        }) : delay_;\n        if (delay) await (0, wait_js_1.wait)(delay);\n        attemptRetry({\n          count: count + 1\n        });\n      };\n      try {\n        const data = await fn();\n        resolve(data);\n      } catch (err) {\n        if (count < retryCount && (await shouldRetry({\n          count,\n          error: err\n        }))) return retry({\n          error: err\n        });\n        reject(err);\n      }\n    };\n    attemptRetry();\n  });\n}","map":{"version":3,"names":["exports","withRetry","wait_js_1","require","fn","delay","delay_","retryCount","shouldRetry","Promise","resolve","reject","attemptRetry","count","retry","error","wait","data","err"],"sources":["/home/sumedhshete/visitor-counter/frontend/node_modules/viem/utils/promise/withRetry.ts"],"sourcesContent":["import type { ErrorType } from '../../errors/utils.js'\nimport { wait } from '../wait.js'\n\nexport type WithRetryParameters = {\n  // The delay (in ms) between retries.\n  delay?:\n    | ((config: { count: number; error: Error }) => number)\n    | number\n    | undefined\n  // The max number of times to retry.\n  retryCount?: number | undefined\n  // Whether or not to retry when an error is thrown.\n  shouldRetry?:\n    | (({\n        count,\n        error,\n      }: {\n        count: number\n        error: Error\n      }) => Promise<boolean> | boolean)\n    | undefined\n}\n\nexport type WithRetryErrorType = ErrorType\n\nexport function withRetry<data>(\n  fn: () => Promise<data>,\n  {\n    delay: delay_ = 100,\n    retryCount = 2,\n    shouldRetry = () => true,\n  }: WithRetryParameters = {},\n) {\n  return new Promise<data>((resolve, reject) => {\n    const attemptRetry = async ({ count = 0 } = {}) => {\n      const retry = async ({ error }: { error: Error }) => {\n        const delay =\n          typeof delay_ === 'function' ? delay_({ count, error }) : delay_\n        if (delay) await wait(delay)\n        attemptRetry({ count: count + 1 })\n      }\n\n      try {\n        const data = await fn()\n        resolve(data)\n      } catch (err) {\n        if (\n          count < retryCount &&\n          (await shouldRetry({ count, error: err as Error }))\n        )\n          return retry({ error: err as Error })\n        reject(err)\n      }\n    }\n    attemptRetry()\n  })\n}\n"],"mappings":";;;;;AAyBAA,OAAA,CAAAC,SAAA,GAAAA,SAAA;AAxBA,MAAAC,SAAA,GAAAC,OAAA;AAwBA,SAAgBF,SAASA,CACvBG,EAAuB,EACvB;EACEC,KAAK,EAAEC,MAAM,GAAG,GAAG;EACnBC,UAAU,GAAG,CAAC;EACdC,WAAW,GAAGA,CAAA,KAAM;AAAI,IACD,EAAE;EAE3B,OAAO,IAAIC,OAAO,CAAO,CAACC,OAAO,EAAEC,MAAM,KAAI;IAC3C,MAAMC,YAAY,GAAG,MAAAA,CAAO;MAAEC,KAAK,GAAG;IAAC,CAAE,GAAG,EAAE,KAAI;MAChD,MAAMC,KAAK,GAAG,MAAAA,CAAO;QAAEC;MAAK,CAAoB,KAAI;QAClD,MAAMV,KAAK,GACT,OAAOC,MAAM,KAAK,UAAU,GAAGA,MAAM,CAAC;UAAEO,KAAK;UAAEE;QAAK,CAAE,CAAC,GAAGT,MAAM;QAClE,IAAID,KAAK,EAAE,MAAM,IAAAH,SAAA,CAAAc,IAAI,EAACX,KAAK,CAAC;QAC5BO,YAAY,CAAC;UAAEC,KAAK,EAAEA,KAAK,GAAG;QAAC,CAAE,CAAC;MACpC,CAAC;MAED,IAAI;QACF,MAAMI,IAAI,GAAG,MAAMb,EAAE,EAAE;QACvBM,OAAO,CAACO,IAAI,CAAC;MACf,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZ,IACEL,KAAK,GAAGN,UAAU,KACjB,MAAMC,WAAW,CAAC;UAAEK,KAAK;UAAEE,KAAK,EAAEG;QAAY,CAAE,CAAC,CAAC,EAEnD,OAAOJ,KAAK,CAAC;UAAEC,KAAK,EAAEG;QAAY,CAAE,CAAC;QACvCP,MAAM,CAACO,GAAG,CAAC;MACb;IACF,CAAC;IACDN,YAAY,EAAE;EAChB,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}