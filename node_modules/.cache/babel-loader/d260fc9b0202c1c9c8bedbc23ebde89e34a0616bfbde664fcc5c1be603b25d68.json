{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCallsStatus = getCallsStatus;\nconst slice_js_1 = require(\"../../utils/data/slice.js\");\nconst trim_js_1 = require(\"../../utils/data/trim.js\");\nconst fromHex_js_1 = require(\"../../utils/encoding/fromHex.js\");\nconst transactionReceipt_js_1 = require(\"../../utils/formatters/transactionReceipt.js\");\nconst sendCalls_js_1 = require(\"./sendCalls.js\");\nasync function getCallsStatus(client, parameters) {\n  async function getStatus(id) {\n    const isTransactions = id.endsWith(sendCalls_js_1.fallbackMagicIdentifier.slice(2));\n    if (isTransactions) {\n      const chainId = (0, trim_js_1.trim)((0, slice_js_1.sliceHex)(id, -64, -32));\n      const hashes = (0, slice_js_1.sliceHex)(id, 0, -64).slice(2).match(/.{1,64}/g);\n      const receipts = await Promise.all(hashes.map(hash => sendCalls_js_1.fallbackTransactionErrorMagicIdentifier.slice(2) !== hash ? client.request({\n        method: 'eth_getTransactionReceipt',\n        params: [`0x${hash}`]\n      }, {\n        dedupe: true\n      }) : undefined));\n      const status = (() => {\n        if (receipts.some(r => r === null)) return 100;\n        if (receipts.every(r => r?.status === '0x1')) return 200;\n        if (receipts.every(r => r?.status === '0x0')) return 500;\n        return 600;\n      })();\n      return {\n        atomic: false,\n        chainId: (0, fromHex_js_1.hexToNumber)(chainId),\n        receipts: receipts.filter(Boolean),\n        status,\n        version: '2.0.0'\n      };\n    }\n    return client.request({\n      method: 'wallet_getCallsStatus',\n      params: [id]\n    });\n  }\n  const {\n    atomic = false,\n    chainId,\n    receipts,\n    version = '2.0.0',\n    ...response\n  } = await getStatus(parameters.id);\n  const [status, statusCode] = (() => {\n    const statusCode = response.status;\n    if (statusCode >= 100 && statusCode < 200) return ['pending', statusCode];\n    if (statusCode >= 200 && statusCode < 300) return ['success', statusCode];\n    if (statusCode >= 300 && statusCode < 700) return ['failure', statusCode];\n    if (statusCode === 'CONFIRMED') return ['success', 200];\n    if (statusCode === 'PENDING') return ['pending', 100];\n    return [undefined, statusCode];\n  })();\n  return {\n    ...response,\n    atomic,\n    chainId: chainId ? (0, fromHex_js_1.hexToNumber)(chainId) : undefined,\n    receipts: receipts?.map(receipt => ({\n      ...receipt,\n      blockNumber: (0, fromHex_js_1.hexToBigInt)(receipt.blockNumber),\n      gasUsed: (0, fromHex_js_1.hexToBigInt)(receipt.gasUsed),\n      status: transactionReceipt_js_1.receiptStatuses[receipt.status]\n    })) ?? [],\n    statusCode,\n    status,\n    version\n  };\n}","map":{"version":3,"names":["exports","getCallsStatus","slice_js_1","require","trim_js_1","fromHex_js_1","transactionReceipt_js_1","sendCalls_js_1","client","parameters","getStatus","id","isTransactions","endsWith","fallbackMagicIdentifier","slice","chainId","trim","sliceHex","hashes","match","receipts","Promise","all","map","hash","fallbackTransactionErrorMagicIdentifier","request","method","params","dedupe","undefined","status","some","r","every","atomic","hexToNumber","filter","Boolean","version","response","statusCode","receipt","blockNumber","hexToBigInt","gasUsed","receiptStatuses"],"sources":["/home/sumedhshete/visitor-counter/frontend/node_modules/viem/actions/wallet/getCallsStatus.ts"],"sourcesContent":["import type { Client } from '../../clients/createClient.js'\nimport type { Transport } from '../../clients/transports/createTransport.js'\nimport type { ErrorType } from '../../errors/utils.js'\nimport type { Account } from '../../types/account.js'\nimport type { ExtractCapabilities } from '../../types/capabilities.js'\nimport type { Chain } from '../../types/chain.js'\nimport type { WalletGetCallsStatusReturnType } from '../../types/eip1193.js'\nimport type { Hex } from '../../types/misc.js'\nimport type { RpcTransactionReceipt } from '../../types/rpc.js'\nimport type { Prettify } from '../../types/utils.js'\nimport type { RequestErrorType } from '../../utils/buildRequest.js'\nimport { sliceHex } from '../../utils/data/slice.js'\nimport { trim } from '../../utils/data/trim.js'\nimport { hexToBigInt, hexToNumber } from '../../utils/encoding/fromHex.js'\nimport { receiptStatuses } from '../../utils/formatters/transactionReceipt.js'\nimport {\n  fallbackMagicIdentifier,\n  fallbackTransactionErrorMagicIdentifier,\n} from './sendCalls.js'\n\nexport type GetCallsStatusParameters = { id: string }\n\nexport type GetCallsStatusReturnType = Prettify<\n  Omit<\n    WalletGetCallsStatusReturnType<\n      ExtractCapabilities<'getCallsStatus', 'ReturnType'>,\n      number,\n      bigint,\n      'success' | 'reverted'\n    >,\n    'status'\n  > & {\n    statusCode: number\n    status: 'pending' | 'success' | 'failure' | undefined\n  }\n>\n\nexport type GetCallsStatusErrorType = RequestErrorType | ErrorType\n\n/**\n * Returns the status of a call batch that was sent via `sendCalls`.\n *\n * - Docs: https://viem.sh/docs/actions/wallet/getCallsStatus\n * - JSON-RPC Methods: [`wallet_getCallsStatus`](https://eips.ethereum.org/EIPS/eip-5792)\n *\n * @param client - Client to use\n * @returns Status of the calls. {@link GetCallsStatusReturnType}\n *\n * @example\n * import { createWalletClient, custom } from 'viem'\n * import { mainnet } from 'viem/chains'\n * import { getCallsStatus } from 'viem/actions'\n *\n * const client = createWalletClient({\n *   chain: mainnet,\n *   transport: custom(window.ethereum),\n * })\n * const { receipts, status } = await getCallsStatus(client, { id: '0xdeadbeef' })\n */\nexport async function getCallsStatus<\n  chain extends Chain | undefined,\n  account extends Account | undefined = undefined,\n>(\n  client: Client<Transport, chain, account>,\n  parameters: GetCallsStatusParameters,\n): Promise<GetCallsStatusReturnType> {\n  async function getStatus(id: Hex) {\n    const isTransactions = id.endsWith(fallbackMagicIdentifier.slice(2))\n    if (isTransactions) {\n      const chainId = trim(sliceHex(id, -64, -32))\n      const hashes = sliceHex(id, 0, -64)\n        .slice(2)\n        .match(/.{1,64}/g)\n\n      const receipts = await Promise.all(\n        hashes!.map((hash) =>\n          fallbackTransactionErrorMagicIdentifier.slice(2) !== hash\n            ? client.request(\n                {\n                  method: 'eth_getTransactionReceipt',\n                  params: [`0x${hash}`],\n                },\n                { dedupe: true },\n              )\n            : undefined,\n        ),\n      )\n\n      const status = (() => {\n        if (receipts.some((r) => r === null)) return 100 // pending\n        if (receipts.every((r) => r?.status === '0x1')) return 200 // success\n        if (receipts.every((r) => r?.status === '0x0')) return 500 // complete failure\n        return 600 // partial failure\n      })()\n\n      return {\n        atomic: false,\n        chainId: hexToNumber(chainId),\n        receipts: receipts.filter(Boolean) as RpcTransactionReceipt[],\n        status,\n        version: '2.0.0',\n      }\n    }\n    return client.request({\n      method: 'wallet_getCallsStatus',\n      params: [id],\n    })\n  }\n\n  const {\n    atomic = false,\n    chainId,\n    receipts,\n    version = '2.0.0',\n    ...response\n  } = await getStatus(parameters.id as Hex)\n  const [status, statusCode] = (() => {\n    const statusCode = response.status\n    if (statusCode >= 100 && statusCode < 200)\n      return ['pending', statusCode] as const\n    if (statusCode >= 200 && statusCode < 300)\n      return ['success', statusCode] as const\n    if (statusCode >= 300 && statusCode < 700)\n      return ['failure', statusCode] as const\n    // @ts-expect-error: for backwards compatibility\n    if (statusCode === 'CONFIRMED') return ['success', 200] as const\n    // @ts-expect-error: for backwards compatibility\n    if (statusCode === 'PENDING') return ['pending', 100] as const\n    return [undefined, statusCode]\n  })()\n  return {\n    ...response,\n    atomic,\n    // @ts-expect-error: for backwards compatibility\n    chainId: chainId ? hexToNumber(chainId) : undefined,\n    receipts:\n      receipts?.map((receipt) => ({\n        ...receipt,\n        blockNumber: hexToBigInt(receipt.blockNumber),\n        gasUsed: hexToBigInt(receipt.gasUsed),\n        status: receiptStatuses[receipt.status as '0x0' | '0x1'],\n      })) ?? [],\n    statusCode,\n    status,\n    version,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}