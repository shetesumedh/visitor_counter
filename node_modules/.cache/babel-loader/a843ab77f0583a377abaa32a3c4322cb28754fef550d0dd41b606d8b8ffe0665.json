{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { LitElement, html } from 'lit';\nimport { state } from 'lit/decorators.js';\nimport { ChainController, ConnectionController, CoreHelperUtil, EventsController, ModalController, OptionsController, RouterController, SnackController } from '@reown/appkit-controllers';\nimport { customElement } from '@reown/appkit-ui';\nimport '../../partials/w3m-connecting-header/index.js';\nimport '../../partials/w3m-connecting-wc-browser/index.js';\nimport '../../partials/w3m-connecting-wc-desktop/index.js';\nimport '../../partials/w3m-connecting-wc-mobile/index.js';\nimport '../../partials/w3m-connecting-wc-qrcode/index.js';\nimport '../../partials/w3m-connecting-wc-unsupported/index.js';\nimport '../../partials/w3m-connecting-wc-web/index.js';\nlet W3mConnectingWcView = class W3mConnectingWcView extends LitElement {\n  constructor() {\n    super();\n    this.wallet = RouterController.state.data?.wallet;\n    this.unsubscribe = [];\n    this.platform = undefined;\n    this.platforms = [];\n    this.isSiwxEnabled = Boolean(OptionsController.state.siwx);\n    this.remoteFeatures = OptionsController.state.remoteFeatures;\n    this.determinePlatforms();\n    this.initializeConnection();\n    this.unsubscribe.push(OptionsController.subscribeKey('remoteFeatures', val => this.remoteFeatures = val));\n  }\n  disconnectedCallback() {\n    this.unsubscribe.forEach(unsubscribe => unsubscribe());\n  }\n  render() {\n    return html`\n      ${this.headerTemplate()}\n      <div>${this.platformTemplate()}</div>\n      ${this.reownBrandingTemplate()}\n    `;\n  }\n  reownBrandingTemplate() {\n    if (!this.remoteFeatures?.reownBranding) {\n      return null;\n    }\n    return html`<wui-ux-by-reown></wui-ux-by-reown>`;\n  }\n  async initializeConnection(retry = false) {\n    if (this.platform === 'browser' || OptionsController.state.manualWCControl && !retry) {\n      return;\n    }\n    try {\n      const {\n        wcPairingExpiry,\n        status\n      } = ConnectionController.state;\n      if (retry || OptionsController.state.enableEmbedded || CoreHelperUtil.isPairingExpired(wcPairingExpiry) || status === 'connecting') {\n        await ConnectionController.connectWalletConnect();\n        if (!this.isSiwxEnabled) {\n          ModalController.close();\n        }\n      }\n    } catch (error) {\n      EventsController.sendEvent({\n        type: 'track',\n        event: 'CONNECT_ERROR',\n        properties: {\n          message: error?.message ?? 'Unknown'\n        }\n      });\n      ConnectionController.setWcError(true);\n      SnackController.showError(error.message ?? 'Connection error');\n      ConnectionController.resetWcConnection();\n      RouterController.goBack();\n    }\n  }\n  determinePlatforms() {\n    if (!this.wallet) {\n      this.platforms.push('qrcode');\n      this.platform = 'qrcode';\n      return;\n    }\n    if (this.platform) {\n      return;\n    }\n    const {\n      mobile_link,\n      desktop_link,\n      webapp_link,\n      injected,\n      rdns\n    } = this.wallet;\n    const injectedIds = injected?.map(({\n      injected_id\n    }) => injected_id).filter(Boolean);\n    const browserIds = [...(rdns ? [rdns] : injectedIds ?? [])];\n    const isBrowser = OptionsController.state.isUniversalProvider ? false : browserIds.length;\n    const hasMobileWCLink = mobile_link;\n    const isWebWc = webapp_link;\n    const isBrowserInstalled = ConnectionController.checkInstalled(browserIds);\n    const isBrowserWc = isBrowser && isBrowserInstalled;\n    const isDesktopWc = desktop_link && !CoreHelperUtil.isMobile();\n    if (isBrowserWc && !ChainController.state.noAdapters) {\n      this.platforms.push('browser');\n    }\n    if (hasMobileWCLink) {\n      this.platforms.push(CoreHelperUtil.isMobile() ? 'mobile' : 'qrcode');\n    }\n    if (isWebWc) {\n      this.platforms.push('web');\n    }\n    if (isDesktopWc) {\n      this.platforms.push('desktop');\n    }\n    if (!isBrowserWc && isBrowser && !ChainController.state.noAdapters) {\n      this.platforms.push('unsupported');\n    }\n    this.platform = this.platforms[0];\n  }\n  platformTemplate() {\n    switch (this.platform) {\n      case 'browser':\n        return html`<w3m-connecting-wc-browser></w3m-connecting-wc-browser>`;\n      case 'web':\n        return html`<w3m-connecting-wc-web></w3m-connecting-wc-web>`;\n      case 'desktop':\n        return html`\n          <w3m-connecting-wc-desktop .onRetry=${() => this.initializeConnection(true)}>\n          </w3m-connecting-wc-desktop>\n        `;\n      case 'mobile':\n        return html`\n          <w3m-connecting-wc-mobile isMobile .onRetry=${() => this.initializeConnection(true)}>\n          </w3m-connecting-wc-mobile>\n        `;\n      case 'qrcode':\n        return html`<w3m-connecting-wc-qrcode></w3m-connecting-wc-qrcode>`;\n      default:\n        return html`<w3m-connecting-wc-unsupported></w3m-connecting-wc-unsupported>`;\n    }\n  }\n  headerTemplate() {\n    const multiPlatform = this.platforms.length > 1;\n    if (!multiPlatform) {\n      return null;\n    }\n    return html`\n      <w3m-connecting-header\n        .platforms=${this.platforms}\n        .onSelectPlatfrom=${this.onSelectPlatform.bind(this)}\n      >\n      </w3m-connecting-header>\n    `;\n  }\n  async onSelectPlatform(platform) {\n    const container = this.shadowRoot?.querySelector('div');\n    if (container) {\n      await container.animate([{\n        opacity: 1\n      }, {\n        opacity: 0\n      }], {\n        duration: 200,\n        fill: 'forwards',\n        easing: 'ease'\n      }).finished;\n      this.platform = platform;\n      container.animate([{\n        opacity: 0\n      }, {\n        opacity: 1\n      }], {\n        duration: 200,\n        fill: 'forwards',\n        easing: 'ease'\n      });\n    }\n  }\n};\n__decorate([state()], W3mConnectingWcView.prototype, \"platform\", void 0);\n__decorate([state()], W3mConnectingWcView.prototype, \"platforms\", void 0);\n__decorate([state()], W3mConnectingWcView.prototype, \"isSiwxEnabled\", void 0);\n__decorate([state()], W3mConnectingWcView.prototype, \"remoteFeatures\", void 0);\nW3mConnectingWcView = __decorate([customElement('w3m-connecting-wc-view')], W3mConnectingWcView);\nexport { W3mConnectingWcView };","map":{"version":3,"names":["LitElement","html","state","ChainController","ConnectionController","CoreHelperUtil","EventsController","ModalController","OptionsController","RouterController","SnackController","customElement","W3mConnectingWcView","constructor","wallet","data","unsubscribe","platform","undefined","platforms","isSiwxEnabled","Boolean","siwx","remoteFeatures","determinePlatforms","initializeConnection","push","subscribeKey","val","disconnectedCallback","forEach","render","headerTemplate","platformTemplate","reownBrandingTemplate","reownBranding","retry","manualWCControl","wcPairingExpiry","status","enableEmbedded","isPairingExpired","connectWalletConnect","close","error","sendEvent","type","event","properties","message","setWcError","showError","resetWcConnection","goBack","mobile_link","desktop_link","webapp_link","injected","rdns","injectedIds","map","injected_id","filter","browserIds","isBrowser","isUniversalProvider","length","hasMobileWCLink","isWebWc","isBrowserInstalled","checkInstalled","isBrowserWc","isDesktopWc","isMobile","noAdapters","multiPlatform","onSelectPlatform","bind","container","shadowRoot","querySelector","animate","opacity","duration","fill","easing","finished","__decorate"],"sources":["../../../../../src/views/w3m-connecting-wc-view/index.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}