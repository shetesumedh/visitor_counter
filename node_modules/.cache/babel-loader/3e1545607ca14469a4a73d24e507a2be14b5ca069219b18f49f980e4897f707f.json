{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.poll = poll;\nconst wait_js_1 = require(\"./wait.js\");\nfunction poll(fn, {\n  emitOnBegin,\n  initialWaitTime,\n  interval\n}) {\n  let active = true;\n  const unwatch = () => active = false;\n  const watch = async () => {\n    let data = undefined;\n    if (emitOnBegin) data = await fn({\n      unpoll: unwatch\n    });\n    const initialWait = (await initialWaitTime?.(data)) ?? interval;\n    await (0, wait_js_1.wait)(initialWait);\n    const poll = async () => {\n      if (!active) return;\n      await fn({\n        unpoll: unwatch\n      });\n      await (0, wait_js_1.wait)(interval);\n      poll();\n    };\n    poll();\n  };\n  watch();\n  return unwatch;\n}","map":{"version":3,"names":["exports","poll","wait_js_1","require","fn","emitOnBegin","initialWaitTime","interval","active","unwatch","watch","data","undefined","unpoll","initialWait","wait"],"sources":["/home/sumedhshete/visitor-counter/frontend/node_modules/viem/utils/poll.ts"],"sourcesContent":["import type { ErrorType } from '../errors/utils.js'\nimport { wait } from './wait.js'\n\ntype PollOptions<data> = {\n  // Whether or not to emit when the polling starts.\n  emitOnBegin?: boolean | undefined\n  // The initial wait time (in ms) before polling.\n  initialWaitTime?: ((data: data | void) => Promise<number>) | undefined\n  // The interval (in ms).\n  interval: number\n}\n\nexport type PollErrorType = ErrorType\n\n/**\n * @description Polls a function at a specified interval.\n */\nexport function poll<data>(\n  fn: ({ unpoll }: { unpoll: () => void }) => Promise<data | void>,\n  { emitOnBegin, initialWaitTime, interval }: PollOptions<data>,\n) {\n  let active = true\n\n  const unwatch = () => (active = false)\n\n  const watch = async () => {\n    let data: data | void = undefined\n    if (emitOnBegin) data = await fn({ unpoll: unwatch })\n\n    const initialWait = (await initialWaitTime?.(data)) ?? interval\n    await wait(initialWait)\n\n    const poll = async () => {\n      if (!active) return\n      await fn({ unpoll: unwatch })\n      await wait(interval)\n      poll()\n    }\n\n    poll()\n  }\n  watch()\n\n  return unwatch\n}\n"],"mappings":";;;;;AAiBAA,OAAA,CAAAC,IAAA,GAAAA,IAAA;AAhBA,MAAAC,SAAA,GAAAC,OAAA;AAgBA,SAAgBF,IAAIA,CAClBG,EAAgE,EAChE;EAAEC,WAAW;EAAEC,eAAe;EAAEC;AAAQ,CAAqB;EAE7D,IAAIC,MAAM,GAAG,IAAI;EAEjB,MAAMC,OAAO,GAAGA,CAAA,KAAOD,MAAM,GAAG,KAAM;EAEtC,MAAME,KAAK,GAAG,MAAAA,CAAA,KAAW;IACvB,IAAIC,IAAI,GAAgBC,SAAS;IACjC,IAAIP,WAAW,EAAEM,IAAI,GAAG,MAAMP,EAAE,CAAC;MAAES,MAAM,EAAEJ;IAAO,CAAE,CAAC;IAErD,MAAMK,WAAW,GAAG,CAAC,MAAMR,eAAe,GAAGK,IAAI,CAAC,KAAKJ,QAAQ;IAC/D,MAAM,IAAAL,SAAA,CAAAa,IAAI,EAACD,WAAW,CAAC;IAEvB,MAAMb,IAAI,GAAG,MAAAA,CAAA,KAAW;MACtB,IAAI,CAACO,MAAM,EAAE;MACb,MAAMJ,EAAE,CAAC;QAAES,MAAM,EAAEJ;MAAO,CAAE,CAAC;MAC7B,MAAM,IAAAP,SAAA,CAAAa,IAAI,EAACR,QAAQ,CAAC;MACpBN,IAAI,EAAE;IACR,CAAC;IAEDA,IAAI,EAAE;EACR,CAAC;EACDS,KAAK,EAAE;EAEP,OAAOD,OAAO;AAChB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}