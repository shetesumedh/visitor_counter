{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.estimateMaxPriorityFeePerGas = estimateMaxPriorityFeePerGas;\nexports.internal_estimateMaxPriorityFeePerGas = internal_estimateMaxPriorityFeePerGas;\nconst fee_js_1 = require(\"../../errors/fee.js\");\nconst fromHex_js_1 = require(\"../../utils/encoding/fromHex.js\");\nconst getAction_js_1 = require(\"../../utils/getAction.js\");\nconst getBlock_js_1 = require(\"./getBlock.js\");\nconst getGasPrice_js_1 = require(\"./getGasPrice.js\");\nasync function estimateMaxPriorityFeePerGas(client, args) {\n  return internal_estimateMaxPriorityFeePerGas(client, args);\n}\nasync function internal_estimateMaxPriorityFeePerGas(client, args) {\n  const {\n    block: block_,\n    chain = client.chain,\n    request\n  } = args || {};\n  try {\n    const maxPriorityFeePerGas = chain?.fees?.maxPriorityFeePerGas ?? chain?.fees?.defaultPriorityFee;\n    if (typeof maxPriorityFeePerGas === 'function') {\n      const block = block_ || (await (0, getAction_js_1.getAction)(client, getBlock_js_1.getBlock, 'getBlock')({}));\n      const maxPriorityFeePerGas_ = await maxPriorityFeePerGas({\n        block,\n        client,\n        request\n      });\n      if (maxPriorityFeePerGas_ === null) throw new Error();\n      return maxPriorityFeePerGas_;\n    }\n    if (typeof maxPriorityFeePerGas !== 'undefined') return maxPriorityFeePerGas;\n    const maxPriorityFeePerGasHex = await client.request({\n      method: 'eth_maxPriorityFeePerGas'\n    });\n    return (0, fromHex_js_1.hexToBigInt)(maxPriorityFeePerGasHex);\n  } catch {\n    const [block, gasPrice] = await Promise.all([block_ ? Promise.resolve(block_) : (0, getAction_js_1.getAction)(client, getBlock_js_1.getBlock, 'getBlock')({}), (0, getAction_js_1.getAction)(client, getGasPrice_js_1.getGasPrice, 'getGasPrice')({})]);\n    if (typeof block.baseFeePerGas !== 'bigint') throw new fee_js_1.Eip1559FeesNotSupportedError();\n    const maxPriorityFeePerGas = gasPrice - block.baseFeePerGas;\n    if (maxPriorityFeePerGas < 0n) return 0n;\n    return maxPriorityFeePerGas;\n  }\n}","map":{"version":3,"names":["exports","estimateMaxPriorityFeePerGas","internal_estimateMaxPriorityFeePerGas","fee_js_1","require","fromHex_js_1","getAction_js_1","getBlock_js_1","getGasPrice_js_1","client","args","block","block_","chain","request","maxPriorityFeePerGas","fees","defaultPriorityFee","getAction","getBlock","maxPriorityFeePerGas_","Error","maxPriorityFeePerGasHex","method","hexToBigInt","gasPrice","Promise","all","resolve","getGasPrice","baseFeePerGas","Eip1559FeesNotSupportedError"],"sources":["/home/sumedhshete/visitor-counter/frontend/node_modules/viem/actions/public/estimateMaxPriorityFeePerGas.ts"],"sourcesContent":["import type { Client } from '../../clients/createClient.js'\nimport type { Transport } from '../../clients/transports/createTransport.js'\nimport {\n  Eip1559FeesNotSupportedError,\n  type Eip1559FeesNotSupportedErrorType,\n} from '../../errors/fee.js'\nimport type { ErrorType } from '../../errors/utils.js'\nimport type { Account } from '../../types/account.js'\nimport type { Block } from '../../types/block.js'\nimport type { Chain, ChainFeesFnParameters } from '../../types/chain.js'\nimport type { GetChainParameter } from '../../types/chain.js'\nimport type { RequestErrorType } from '../../utils/buildRequest.js'\nimport {\n  type HexToBigIntErrorType,\n  hexToBigInt,\n} from '../../utils/encoding/fromHex.js'\nimport { getAction } from '../../utils/getAction.js'\nimport type { PrepareTransactionRequestParameters } from '../wallet/prepareTransactionRequest.js'\nimport { type GetBlockErrorType, getBlock } from './getBlock.js'\nimport { type GetGasPriceErrorType, getGasPrice } from './getGasPrice.js'\n\nexport type EstimateMaxPriorityFeePerGasParameters<\n  chain extends Chain | undefined = Chain | undefined,\n  chainOverride extends Chain | undefined = Chain | undefined,\n> = GetChainParameter<chain, chainOverride>\n\nexport type EstimateMaxPriorityFeePerGasReturnType = bigint\n\nexport type EstimateMaxPriorityFeePerGasErrorType =\n  | GetBlockErrorType\n  | HexToBigIntErrorType\n  | RequestErrorType\n  | GetBlockErrorType\n  | GetGasPriceErrorType\n  | Eip1559FeesNotSupportedErrorType\n  | ErrorType\n\n/**\n * Returns an estimate for the max priority fee per gas (in wei) for a\n * transaction to be likely included in the next block.\n * Defaults to [`chain.fees.defaultPriorityFee`](/docs/clients/chains#fees-defaultpriorityfee) if set.\n *\n * - Docs: https://viem.sh/docs/actions/public/estimateMaxPriorityFeePerGas\n *\n * @param client - Client to use\n * @returns An estimate (in wei) for the max priority fee per gas. {@link EstimateMaxPriorityFeePerGasReturnType}\n *\n * @example\n * import { createPublicClient, http } from 'viem'\n * import { mainnet } from 'viem/chains'\n * import { estimateMaxPriorityFeePerGas } from 'viem/actions'\n *\n * const client = createPublicClient({\n *   chain: mainnet,\n *   transport: http(),\n * })\n * const maxPriorityFeePerGas = await estimateMaxPriorityFeePerGas(client)\n * // 10000000n\n */\nexport async function estimateMaxPriorityFeePerGas<\n  chain extends Chain | undefined,\n  chainOverride extends Chain | undefined,\n>(\n  client: Client<Transport, chain>,\n  args?:\n    | EstimateMaxPriorityFeePerGasParameters<chain, chainOverride>\n    | undefined,\n): Promise<EstimateMaxPriorityFeePerGasReturnType> {\n  return internal_estimateMaxPriorityFeePerGas(client, args as any)\n}\n\nexport async function internal_estimateMaxPriorityFeePerGas<\n  chain extends Chain | undefined,\n  chainOverride extends Chain | undefined,\n>(\n  client: Client<Transport, chain>,\n  args: EstimateMaxPriorityFeePerGasParameters<chain, chainOverride> & {\n    block?: Block | undefined\n    request?:\n      | PrepareTransactionRequestParameters<\n          chain,\n          Account | undefined,\n          chainOverride\n        >\n      | undefined\n  },\n): Promise<EstimateMaxPriorityFeePerGasReturnType> {\n  const { block: block_, chain = client.chain, request } = args || {}\n\n  try {\n    const maxPriorityFeePerGas =\n      chain?.fees?.maxPriorityFeePerGas ?? chain?.fees?.defaultPriorityFee\n\n    if (typeof maxPriorityFeePerGas === 'function') {\n      const block =\n        block_ || (await getAction(client, getBlock, 'getBlock')({}))\n      const maxPriorityFeePerGas_ = await maxPriorityFeePerGas({\n        block,\n        client,\n        request,\n      } as ChainFeesFnParameters)\n      if (maxPriorityFeePerGas_ === null) throw new Error()\n      return maxPriorityFeePerGas_\n    }\n\n    if (typeof maxPriorityFeePerGas !== 'undefined') return maxPriorityFeePerGas\n\n    const maxPriorityFeePerGasHex = await client.request({\n      method: 'eth_maxPriorityFeePerGas',\n    })\n    return hexToBigInt(maxPriorityFeePerGasHex)\n  } catch {\n    // If the RPC Provider does not support `eth_maxPriorityFeePerGas`\n    // fall back to calculating it manually via `gasPrice - baseFeePerGas`.\n    // See: https://github.com/ethereum/pm/issues/328#:~:text=eth_maxPriorityFeePerGas%20after%20London%20will%20effectively%20return%20eth_gasPrice%20%2D%20baseFee\n    const [block, gasPrice] = await Promise.all([\n      block_\n        ? Promise.resolve(block_)\n        : getAction(client, getBlock, 'getBlock')({}),\n      getAction(client, getGasPrice, 'getGasPrice')({}),\n    ])\n\n    if (typeof block.baseFeePerGas !== 'bigint')\n      throw new Eip1559FeesNotSupportedError()\n\n    const maxPriorityFeePerGas = gasPrice - block.baseFeePerGas\n\n    if (maxPriorityFeePerGas < 0n) return 0n\n    return maxPriorityFeePerGas\n  }\n}\n"],"mappings":";;;;;AA2DAA,OAAA,CAAAC,4BAAA,GAAAA,4BAAA;AAYAD,OAAA,CAAAE,qCAAA,GAAAA,qCAAA;AArEA,MAAAC,QAAA,GAAAC,OAAA;AAUA,MAAAC,YAAA,GAAAD,OAAA;AAIA,MAAAE,cAAA,GAAAF,OAAA;AAEA,MAAAG,aAAA,GAAAH,OAAA;AACA,MAAAI,gBAAA,GAAAJ,OAAA;AAwCO,eAAeH,4BAA4BA,CAIhDQ,MAAgC,EAChCC,IAEa;EAEb,OAAOR,qCAAqC,CAACO,MAAM,EAAEC,IAAW,CAAC;AACnE;AAEO,eAAeR,qCAAqCA,CAIzDO,MAAgC,EAChCC,IASC;EAED,MAAM;IAAEC,KAAK,EAAEC,MAAM;IAAEC,KAAK,GAAGJ,MAAM,CAACI,KAAK;IAAEC;EAAO,CAAE,GAAGJ,IAAI,IAAI,EAAE;EAEnE,IAAI;IACF,MAAMK,oBAAoB,GACxBF,KAAK,EAAEG,IAAI,EAAED,oBAAoB,IAAIF,KAAK,EAAEG,IAAI,EAAEC,kBAAkB;IAEtE,IAAI,OAAOF,oBAAoB,KAAK,UAAU,EAAE;MAC9C,MAAMJ,KAAK,GACTC,MAAM,KAAK,MAAM,IAAAN,cAAA,CAAAY,SAAS,EAACT,MAAM,EAAEF,aAAA,CAAAY,QAAQ,EAAE,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC;MAC/D,MAAMC,qBAAqB,GAAG,MAAML,oBAAoB,CAAC;QACvDJ,KAAK;QACLF,MAAM;QACNK;OACwB,CAAC;MAC3B,IAAIM,qBAAqB,KAAK,IAAI,EAAE,MAAM,IAAIC,KAAK,EAAE;MACrD,OAAOD,qBAAqB;IAC9B;IAEA,IAAI,OAAOL,oBAAoB,KAAK,WAAW,EAAE,OAAOA,oBAAoB;IAE5E,MAAMO,uBAAuB,GAAG,MAAMb,MAAM,CAACK,OAAO,CAAC;MACnDS,MAAM,EAAE;KACT,CAAC;IACF,OAAO,IAAAlB,YAAA,CAAAmB,WAAW,EAACF,uBAAuB,CAAC;EAC7C,CAAC,CAAC,MAAM;IAIN,MAAM,CAACX,KAAK,EAAEc,QAAQ,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CAC1Cf,MAAM,GACFc,OAAO,CAACE,OAAO,CAAChB,MAAM,CAAC,GACvB,IAAAN,cAAA,CAAAY,SAAS,EAACT,MAAM,EAAEF,aAAA,CAAAY,QAAQ,EAAE,UAAU,CAAC,CAAC,EAAE,CAAC,EAC/C,IAAAb,cAAA,CAAAY,SAAS,EAACT,MAAM,EAAED,gBAAA,CAAAqB,WAAW,EAAE,aAAa,CAAC,CAAC,EAAE,CAAC,CAClD,CAAC;IAEF,IAAI,OAAOlB,KAAK,CAACmB,aAAa,KAAK,QAAQ,EACzC,MAAM,IAAI3B,QAAA,CAAA4B,4BAA4B,EAAE;IAE1C,MAAMhB,oBAAoB,GAAGU,QAAQ,GAAGd,KAAK,CAACmB,aAAa;IAE3D,IAAIf,oBAAoB,GAAG,EAAE,EAAE,OAAO,EAAE;IACxC,OAAOA,oBAAoB;EAC7B;AACF","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}