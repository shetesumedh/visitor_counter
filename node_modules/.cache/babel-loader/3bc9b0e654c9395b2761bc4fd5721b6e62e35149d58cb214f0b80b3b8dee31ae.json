{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.simulateBlocks = simulateBlocks;\nconst BlockOverrides = require(\"ox/BlockOverrides\");\nconst parseAccount_js_1 = require(\"../../accounts/utils/parseAccount.js\");\nconst abi_js_1 = require(\"../../errors/abi.js\");\nconst contract_js_1 = require(\"../../errors/contract.js\");\nconst node_js_1 = require(\"../../errors/node.js\");\nconst decodeFunctionResult_js_1 = require(\"../../utils/abi/decodeFunctionResult.js\");\nconst encodeFunctionData_js_1 = require(\"../../utils/abi/encodeFunctionData.js\");\nconst concat_js_1 = require(\"../../utils/data/concat.js\");\nconst toHex_js_1 = require(\"../../utils/encoding/toHex.js\");\nconst getContractError_js_1 = require(\"../../utils/errors/getContractError.js\");\nconst getNodeError_js_1 = require(\"../../utils/errors/getNodeError.js\");\nconst block_js_1 = require(\"../../utils/formatters/block.js\");\nconst log_js_1 = require(\"../../utils/formatters/log.js\");\nconst transactionRequest_js_1 = require(\"../../utils/formatters/transactionRequest.js\");\nconst stateOverride_js_1 = require(\"../../utils/stateOverride.js\");\nconst assertRequest_js_1 = require(\"../../utils/transaction/assertRequest.js\");\nasync function simulateBlocks(client, parameters) {\n  const {\n    blockNumber,\n    blockTag = client.experimental_blockTag ?? 'latest',\n    blocks,\n    returnFullTransactions,\n    traceTransfers,\n    validation\n  } = parameters;\n  try {\n    const blockStateCalls = [];\n    for (const block of blocks) {\n      const blockOverrides = block.blockOverrides ? BlockOverrides.toRpc(block.blockOverrides) : undefined;\n      const calls = block.calls.map(call_ => {\n        const call = call_;\n        const account = call.account ? (0, parseAccount_js_1.parseAccount)(call.account) : undefined;\n        const data = call.abi ? (0, encodeFunctionData_js_1.encodeFunctionData)(call) : call.data;\n        const request = {\n          ...call,\n          data: call.dataSuffix ? (0, concat_js_1.concat)([data || '0x', call.dataSuffix]) : data,\n          from: call.from ?? account?.address\n        };\n        (0, assertRequest_js_1.assertRequest)(request);\n        return (0, transactionRequest_js_1.formatTransactionRequest)(request);\n      });\n      const stateOverrides = block.stateOverrides ? (0, stateOverride_js_1.serializeStateOverride)(block.stateOverrides) : undefined;\n      blockStateCalls.push({\n        blockOverrides,\n        calls,\n        stateOverrides\n      });\n    }\n    const blockNumberHex = typeof blockNumber === 'bigint' ? (0, toHex_js_1.numberToHex)(blockNumber) : undefined;\n    const block = blockNumberHex || blockTag;\n    const result = await client.request({\n      method: 'eth_simulateV1',\n      params: [{\n        blockStateCalls,\n        returnFullTransactions,\n        traceTransfers,\n        validation\n      }, block]\n    });\n    return result.map((block, i) => ({\n      ...(0, block_js_1.formatBlock)(block),\n      calls: block.calls.map((call, j) => {\n        const {\n          abi,\n          args,\n          functionName,\n          to\n        } = blocks[i].calls[j];\n        const data = call.error?.data ?? call.returnData;\n        const gasUsed = BigInt(call.gasUsed);\n        const logs = call.logs?.map(log => (0, log_js_1.formatLog)(log));\n        const status = call.status === '0x1' ? 'success' : 'failure';\n        const result = abi && status === 'success' && data !== '0x' ? (0, decodeFunctionResult_js_1.decodeFunctionResult)({\n          abi,\n          data,\n          functionName\n        }) : null;\n        const error = (() => {\n          if (status === 'success') return undefined;\n          let error = undefined;\n          if (call.error?.data === '0x') error = new abi_js_1.AbiDecodingZeroDataError();else if (call.error) error = new contract_js_1.RawContractError(call.error);\n          if (!error) return undefined;\n          return (0, getContractError_js_1.getContractError)(error, {\n            abi: abi ?? [],\n            address: to ?? '0x',\n            args,\n            functionName: functionName ?? '<unknown>'\n          });\n        })();\n        return {\n          data,\n          gasUsed,\n          logs,\n          status,\n          ...(status === 'success' ? {\n            result\n          } : {\n            error\n          })\n        };\n      })\n    }));\n  } catch (e) {\n    const cause = e;\n    const error = (0, getNodeError_js_1.getNodeError)(cause, {});\n    if (error instanceof node_js_1.UnknownNodeError) throw cause;\n    throw error;\n  }\n}","map":{"version":3,"names":["exports","simulateBlocks","BlockOverrides","require","parseAccount_js_1","abi_js_1","contract_js_1","node_js_1","decodeFunctionResult_js_1","encodeFunctionData_js_1","concat_js_1","toHex_js_1","getContractError_js_1","getNodeError_js_1","block_js_1","log_js_1","transactionRequest_js_1","stateOverride_js_1","assertRequest_js_1","client","parameters","blockNumber","blockTag","experimental_blockTag","blocks","returnFullTransactions","traceTransfers","validation","blockStateCalls","block","blockOverrides","toRpc","undefined","calls","map","call_","call","account","parseAccount","data","abi","encodeFunctionData","request","dataSuffix","concat","from","address","assertRequest","formatTransactionRequest","stateOverrides","serializeStateOverride","push","blockNumberHex","numberToHex","result","method","params","i","formatBlock","j","args","functionName","to","error","returnData","gasUsed","BigInt","logs","log","formatLog","status","decodeFunctionResult","AbiDecodingZeroDataError","RawContractError","getContractError","e","cause","getNodeError","UnknownNodeError"],"sources":["/home/sumedhshete/visitor-counter/frontend_sepolia/node_modules/viem/actions/public/simulateBlocks.ts"],"sourcesContent":["import type { Abi, AbiStateMutability, Address, Narrow } from 'abitype'\nimport * as BlockOverrides from 'ox/BlockOverrides'\n\nimport {\n  type ParseAccountErrorType,\n  parseAccount,\n} from '../../accounts/utils/parseAccount.js'\nimport type { Client } from '../../clients/createClient.js'\nimport type { Transport } from '../../clients/transports/createTransport.js'\nimport { AbiDecodingZeroDataError } from '../../errors/abi.js'\nimport type { BaseError } from '../../errors/base.js'\nimport { RawContractError } from '../../errors/contract.js'\nimport { UnknownNodeError } from '../../errors/node.js'\nimport type { ErrorType } from '../../errors/utils.js'\nimport type { Account } from '../../types/account.js'\nimport type { Block, BlockTag } from '../../types/block.js'\nimport type { Call, Calls } from '../../types/calls.js'\nimport type { Chain } from '../../types/chain.js'\nimport type { Log } from '../../types/log.js'\nimport type { Hex } from '../../types/misc.js'\nimport type { MulticallResults } from '../../types/multicall.js'\nimport type { StateOverride } from '../../types/stateOverride.js'\nimport type { TransactionRequest } from '../../types/transaction.js'\nimport type { ExactPartial, UnionOmit } from '../../types/utils.js'\nimport {\n  type DecodeFunctionResultErrorType,\n  decodeFunctionResult,\n} from '../../utils/abi/decodeFunctionResult.js'\nimport {\n  type EncodeFunctionDataErrorType,\n  encodeFunctionData,\n} from '../../utils/abi/encodeFunctionData.js'\nimport { concat } from '../../utils/data/concat.js'\nimport {\n  type NumberToHexErrorType,\n  numberToHex,\n} from '../../utils/encoding/toHex.js'\nimport { getContractError } from '../../utils/errors/getContractError.js'\nimport {\n  type GetNodeErrorReturnType,\n  getNodeError,\n} from '../../utils/errors/getNodeError.js'\nimport {\n  type FormatBlockErrorType,\n  formatBlock,\n} from '../../utils/formatters/block.js'\nimport { formatLog } from '../../utils/formatters/log.js'\nimport {\n  type FormatTransactionRequestErrorType,\n  formatTransactionRequest,\n} from '../../utils/formatters/transactionRequest.js'\nimport {\n  type SerializeStateOverrideErrorType,\n  serializeStateOverride,\n} from '../../utils/stateOverride.js'\nimport {\n  type AssertRequestErrorType,\n  assertRequest,\n} from '../../utils/transaction/assertRequest.js'\n\ntype CallExtraProperties = ExactPartial<\n  UnionOmit<\n    TransactionRequest,\n    'blobs' | 'data' | 'kzg' | 'to' | 'sidecars' | 'value'\n  >\n> & {\n  /** Account attached to the call (msg.sender). */\n  account?: Account | Address | undefined\n  /** Recipient. `null` if contract deployment. */\n  to?: Address | null | undefined\n}\n\nexport type SimulateBlocksParameters<\n  calls extends readonly unknown[] = readonly unknown[],\n> = {\n  /** Blocks to simulate. */\n  blocks: readonly {\n    /** Block overrides. */\n    blockOverrides?: BlockOverrides.BlockOverrides | undefined\n    /** Calls to execute. */\n    calls: Calls<Narrow<calls>, CallExtraProperties>\n    /** State overrides. */\n    stateOverrides?: StateOverride | undefined\n  }[]\n  /** Whether to return the full transactions. */\n  returnFullTransactions?: boolean | undefined\n  /** Whether to trace transfers. */\n  traceTransfers?: boolean | undefined\n  /** Whether to enable validation mode. */\n  validation?: boolean | undefined\n} & (\n  | {\n      /** The balance of the account at a block number. */\n      blockNumber?: bigint | undefined\n      blockTag?: undefined\n    }\n  | {\n      blockNumber?: undefined\n      /**\n       * The balance of the account at a block tag.\n       * @default 'latest'\n       */\n      blockTag?: BlockTag | undefined\n    }\n)\n\nexport type SimulateBlocksReturnType<\n  calls extends readonly unknown[] = readonly unknown[],\n> = readonly (Block & {\n  calls: MulticallResults<\n    Narrow<calls>,\n    true,\n    {\n      extraProperties: {\n        data: Hex\n        gasUsed: bigint\n        logs?: Log[] | undefined\n      }\n      error: Error\n      mutability: AbiStateMutability\n    }\n  >\n})[]\n\nexport type SimulateBlocksErrorType =\n  | AssertRequestErrorType\n  | DecodeFunctionResultErrorType\n  | EncodeFunctionDataErrorType\n  | FormatBlockErrorType\n  | FormatTransactionRequestErrorType\n  | GetNodeErrorReturnType\n  | ParseAccountErrorType\n  | SerializeStateOverrideErrorType\n  | NumberToHexErrorType\n  | ErrorType\n\n/**\n * Simulates a set of calls on block(s) with optional block and state overrides.\n *\n * @example\n * ```ts\n * import { createClient, http, parseEther } from 'viem'\n * import { simulate } from 'viem/actions'\n * import { mainnet } from 'viem/chains'\n *\n * const client = createClient({\n *   chain: mainnet,\n *   transport: http(),\n * })\n *\n * const result = await simulate(client, {\n *   blocks: [{\n *     blockOverrides: {\n *       number: 69420n,\n *     },\n *     calls: [{\n *       {\n *         account: '0x5a0b54d5dc17e482fe8b0bdca5320161b95fb929',\n *         data: '0xdeadbeef',\n *         to: '0x70997970c51812dc3a010c7d01b50e0d17dc79c8',\n *       },\n *       {\n *         account: '0x5a0b54d5dc17e482fe8b0bdca5320161b95fb929',\n *         to: '0x70997970c51812dc3a010c7d01b50e0d17dc79c8',\n *         value: parseEther('1'),\n *       },\n *     }],\n *     stateOverrides: [{\n *       address: '0x5a0b54d5dc17e482fe8b0bdca5320161b95fb929',\n *       balance: parseEther('10'),\n *     }],\n *   }]\n * })\n * ```\n *\n * @param client - Client to use.\n * @param parameters - {@link SimulateBlocksParameters}\n * @returns Simulated blocks. {@link SimulateBlocksReturnType}\n */\nexport async function simulateBlocks<\n  chain extends Chain | undefined,\n  const calls extends readonly unknown[],\n>(\n  client: Client<Transport, chain>,\n  parameters: SimulateBlocksParameters<calls>,\n): Promise<SimulateBlocksReturnType<calls>> {\n  const {\n    blockNumber,\n    blockTag = client.experimental_blockTag ?? 'latest',\n    blocks,\n    returnFullTransactions,\n    traceTransfers,\n    validation,\n  } = parameters\n\n  try {\n    const blockStateCalls = []\n    for (const block of blocks) {\n      const blockOverrides = block.blockOverrides\n        ? BlockOverrides.toRpc(block.blockOverrides)\n        : undefined\n      const calls = block.calls.map((call_) => {\n        const call = call_ as Call<unknown, CallExtraProperties>\n        const account = call.account ? parseAccount(call.account) : undefined\n        const data = call.abi ? encodeFunctionData(call) : call.data\n        const request = {\n          ...call,\n          data: call.dataSuffix\n            ? concat([data || '0x', call.dataSuffix])\n            : data,\n          from: call.from ?? account?.address,\n        } as const\n        assertRequest(request)\n        return formatTransactionRequest(request)\n      })\n      const stateOverrides = block.stateOverrides\n        ? serializeStateOverride(block.stateOverrides)\n        : undefined\n\n      blockStateCalls.push({\n        blockOverrides,\n        calls,\n        stateOverrides,\n      })\n    }\n\n    const blockNumberHex =\n      typeof blockNumber === 'bigint' ? numberToHex(blockNumber) : undefined\n    const block = blockNumberHex || blockTag\n\n    const result = await client.request({\n      method: 'eth_simulateV1',\n      params: [\n        { blockStateCalls, returnFullTransactions, traceTransfers, validation },\n        block,\n      ],\n    })\n\n    return result.map((block, i) => ({\n      ...formatBlock(block),\n      calls: block.calls.map((call, j) => {\n        const { abi, args, functionName, to } = blocks[i].calls[j] as Call<\n          unknown,\n          CallExtraProperties\n        >\n\n        const data = call.error?.data ?? call.returnData\n        const gasUsed = BigInt(call.gasUsed)\n        const logs = call.logs?.map((log) => formatLog(log))\n        const status = call.status === '0x1' ? 'success' : 'failure'\n\n        const result =\n          abi && status === 'success' && data !== '0x'\n            ? decodeFunctionResult({\n                abi,\n                data,\n                functionName,\n              })\n            : null\n\n        const error = (() => {\n          if (status === 'success') return undefined\n\n          let error = undefined\n          if (call.error?.data === '0x') error = new AbiDecodingZeroDataError()\n          else if (call.error) error = new RawContractError(call.error)\n\n          if (!error) return undefined\n          return getContractError(error, {\n            abi: (abi ?? []) as Abi,\n            address: to ?? '0x',\n            args,\n            functionName: functionName ?? '<unknown>',\n          })\n        })()\n\n        return {\n          data,\n          gasUsed,\n          logs,\n          status,\n          ...(status === 'success'\n            ? {\n                result,\n              }\n            : {\n                error,\n              }),\n        }\n      }),\n    })) as unknown as SimulateBlocksReturnType<calls>\n  } catch (e) {\n    const cause = e as BaseError\n    const error = getNodeError(cause, {})\n    if (error instanceof UnknownNodeError) throw cause\n    throw error\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}